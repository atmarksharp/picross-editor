<project name="picross-editor" default="compile-run" basedir="." xmlns:ivy="antlib:org.apache.ivy.ant">
  <property name="version" value="0.0.1"/>
  <property name="jar-name" value="picross-editor"/>
  <property name="main-class" value="PicrossEditor"/>

  <property name="src" value="." />
  <property name="lib" value="lib"/>
  <property name="build" value="build"/>
  <property name="javac" value="javac"/>

  <path id="lib.path.id">
    <fileset dir="${lib}"/>
  </path>

  <target name="resolve">
    <ivy:retrieve />
  </target>

  <target name="compile" depends="resolve">
    <mkdir dir="${build}" />
    <mkdir dir="${build}/classes" />
    <javac srcdir="${src}" destdir="${build}/classes" classpathref="lib.path.id" target="1.6" source="1.6" executable="${javac}" encoding="UTF-8"/>
  </target>

  <target name="run">
    <java classname="${main-class}" classpath="${build}/classes" classpathref="lib.path.id">
      <arg value="examples/e.txt"/>
    </java>
  </target>

  <target name="compile-run" depends="compile,run">
  </target>

  <target name="jar" depends="compile">
    <delete file="${build}/jar/${jar-name}-${version}.jar"/>
    <mkdir dir="${build}" />
    <mkdir dir="${build}/jar" />
    <jar basedir="${build}/classes" jarfile="${build}/jar/${jar-name}-${version}.jar">
      <restrict>
        <name name="**/*.class"/>
         <archives>
          <zips>
            <fileset dir="${lib}" includes="**/*.jar"/>
          </zips>
        </archives>
      </restrict>
      <manifest>
        <attribute name="Main-Class" value="${main-class}"/>
      </manifest>
    </jar>
  </target>

  <target name="run-jar">
    <java jar="${build}/jar/${jar-name}-${version}.jar" fork="true"/>
  </target>

</project>